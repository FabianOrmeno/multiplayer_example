[gd_scene load_steps=62 format=3 uid="uid://jy540f44o2yf"]

[ext_resource type="Script" uid="uid://bnk17avlc8ydn" path="res://scenes/archer.gd" id="1_ejvcm"]
[ext_resource type="Texture2D" uid="uid://dnij2foc5ir7i" path="res://assets/character_17_frame32x32.png" id="2_c85qa"]
[ext_resource type="PackedScene" uid="uid://euigjgxynrla" path="res://scenes/arrow.tscn" id="2_vlvv2"]
[ext_resource type="Script" uid="uid://6yht3jk70p8w" path="res://components/hurtbox.gd" id="3_vlvv2"]
[ext_resource type="PackedScene" uid="uid://biw121ov2y2lk" path="res://scenes/input_synchronizer.tscn" id="4_d71b8"]
[ext_resource type="PackedScene" uid="uid://byfftl5tridxc" path="res://scenes/bombarrow.tscn" id="4_mak8i"]
[ext_resource type="PackedScene" uid="uid://c3h2fm5awt1cx" path="res://ui/healthbar.tscn" id="7_d71b8"]
[ext_resource type="PackedScene" uid="uid://c5obd4lkhdur4" path="res://scenes/bow.tscn" id="7_vlvv2"]
[ext_resource type="PackedScene" uid="uid://sqqc1otkijsx" path="res://components/health_component.tscn" id="9_1s68y"]
[ext_resource type="PackedScene" uid="uid://cv4400ra23lar" path="res://ui/remote_healthbar.tscn" id="10_88c65"]
[ext_resource type="Script" uid="uid://dvvax2xtfc67f" path="res://scenes/control.gd" id="11_88c65"]
[ext_resource type="Texture2D" uid="uid://dopqmemmee78l" path="res://assets/Pergamino.png" id="12_6mylm"]
[ext_resource type="FontFile" uid="uid://cbcegtquroqbe" path="res://assets/unifont.ttf" id="13_74jyu"]
[ext_resource type="PackedScene" uid="uid://c66fl8u5udhcf" path="res://ui/pause_menu.tscn" id="13_vbhtm"]

[sub_resource type="CircleShape2D" id="CircleShape2D_1s68y"]
radius = 5.09902

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_88c65"]
radius = 4.99977
height = 15.9993

[sub_resource type="Animation" id="Animation_r5lxc"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [7]
}

[sub_resource type="Animation" id="Animation_aoi4v"]
resource_name = "idle"
step = 0.3
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [1]
}

[sub_resource type="Animation" id="Animation_v7jpn"]
resource_name = "idle_down"
length = 0.3
loop_mode = 1
step = 0.3
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [1]
}

[sub_resource type="Animation" id="Animation_trnrn"]
resource_name = "idle_left"
length = 0.3
loop_mode = 1
step = 0.3
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [4]
}

[sub_resource type="Animation" id="Animation_kse8p"]
resource_name = "idle_right"
length = 0.3
loop_mode = 1
step = 0.3
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [7]
}

[sub_resource type="Animation" id="Animation_nu52m"]
resource_name = "idle_up"
length = 0.3
loop_mode = 1
step = 0.3
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [10]
}

[sub_resource type="Animation" id="Animation_yb71v"]
resource_name = "down"
length = 0.8
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [1, 0, 1, 2]
}

[sub_resource type="Animation" id="Animation_nc4w5"]
resource_name = "left"
length = 0.8
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [4, 3, 4, 5]
}

[sub_resource type="Animation" id="Animation_t2cfv"]
resource_name = "right"
length = 0.8
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [7, 8, 7, 6]
}

[sub_resource type="Animation" id="Animation_p0roq"]
resource_name = "up"
length = 0.8
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [10, 9, 10, 11]
}

[sub_resource type="Animation" id="Animation_66amf"]
resource_name = "run"
length = 1.2
loop_mode = 1
step = 0.3
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.3, 0.6, 0.9),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [7, 6, 7, 8]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_66amf"]
_data = {
&"RESET": SubResource("Animation_r5lxc"),
&"idle": SubResource("Animation_aoi4v"),
&"idle_down": SubResource("Animation_v7jpn"),
&"idle_left": SubResource("Animation_trnrn"),
&"idle_right": SubResource("Animation_kse8p"),
&"idle_up": SubResource("Animation_nu52m"),
&"move_down": SubResource("Animation_yb71v"),
&"move_left": SubResource("Animation_nc4w5"),
&"move_right": SubResource("Animation_t2cfv"),
&"move_up": SubResource("Animation_p0roq"),
&"run": SubResource("Animation_66amf")
}

[sub_resource type="LabelSettings" id="LabelSettings_6mylm"]
font_size = 20

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_nc4w5"]
animation = &"idle_down"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_p0roq"]
animation = &"idle_left"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_66amf"]
animation = &"idle_right"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_aoi4v"]
animation = &"idle_up"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_v7jpn"]
animation = &"move_down"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_nu52m"]
animation = &"move_left"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_trnrn"]
animation = &"move_right"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_kse8p"]
animation = &"move_up"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yunhw"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_fi4q4"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_1pdv6"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qtcmm"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ut8cs"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ad11k"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_5qy3h"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_t4vt2"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_bgq4w"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_1v1g5"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_8wtao"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_kpj5n"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xkn1f"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_8phwc"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_b1ljq"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_khq4v"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_u76fy"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_d62h7"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_1tcfv"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ykw3w"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xev1i"]

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_vbhtm"]
states/Start/position = Vector2(189, 100)
states/idle_down/node = SubResource("AnimationNodeAnimation_nc4w5")
states/idle_down/position = Vector2(349, 100)
states/idle_left/node = SubResource("AnimationNodeAnimation_p0roq")
states/idle_left/position = Vector2(349, 181)
states/idle_right/node = SubResource("AnimationNodeAnimation_66amf")
states/idle_right/position = Vector2(349, 270)
states/idle_up/node = SubResource("AnimationNodeAnimation_aoi4v")
states/idle_up/position = Vector2(349, 373)
states/move_down/node = SubResource("AnimationNodeAnimation_v7jpn")
states/move_down/position = Vector2(609, 100)
states/move_left/node = SubResource("AnimationNodeAnimation_nu52m")
states/move_left/position = Vector2(609, 181)
states/move_right/node = SubResource("AnimationNodeAnimation_trnrn")
states/move_right/position = Vector2(609, 270)
states/move_up/node = SubResource("AnimationNodeAnimation_kse8p")
states/move_up/position = Vector2(609, 373)
transitions = ["Start", "idle_down", SubResource("AnimationNodeStateMachineTransition_yunhw"), "idle_down", "move_down", SubResource("AnimationNodeStateMachineTransition_fi4q4"), "idle_down", "move_left", SubResource("AnimationNodeStateMachineTransition_1pdv6"), "idle_down", "move_right", SubResource("AnimationNodeStateMachineTransition_qtcmm"), "idle_down", "move_up", SubResource("AnimationNodeStateMachineTransition_ut8cs"), "move_down", "idle_down", SubResource("AnimationNodeStateMachineTransition_ad11k"), "move_left", "idle_left", SubResource("AnimationNodeStateMachineTransition_5qy3h"), "move_right", "idle_right", SubResource("AnimationNodeStateMachineTransition_t4vt2"), "move_up", "idle_up", SubResource("AnimationNodeStateMachineTransition_bgq4w"), "idle_left", "move_down", SubResource("AnimationNodeStateMachineTransition_1v1g5"), "idle_left", "move_left", SubResource("AnimationNodeStateMachineTransition_8wtao"), "idle_left", "move_right", SubResource("AnimationNodeStateMachineTransition_kpj5n"), "idle_left", "move_up", SubResource("AnimationNodeStateMachineTransition_xkn1f"), "idle_right", "move_right", SubResource("AnimationNodeStateMachineTransition_8phwc"), "idle_right", "move_down", SubResource("AnimationNodeStateMachineTransition_b1ljq"), "idle_right", "move_left", SubResource("AnimationNodeStateMachineTransition_khq4v"), "idle_right", "move_up", SubResource("AnimationNodeStateMachineTransition_u76fy"), "idle_up", "move_up", SubResource("AnimationNodeStateMachineTransition_d62h7"), "idle_up", "move_right", SubResource("AnimationNodeStateMachineTransition_1tcfv"), "idle_up", "move_left", SubResource("AnimationNodeStateMachineTransition_ykw3w"), "idle_up", "move_down", SubResource("AnimationNodeStateMachineTransition_xev1i")]
graph_offset = Vector2(-30, 20)

[sub_resource type="SceneReplicationConfig" id="SceneReplicationConfig_74jyu"]
properties/0/path = NodePath(".:position")
properties/0/spawn = true
properties/0/replication_mode = 1

[sub_resource type="CircleShape2D" id="CircleShape2D_vbhtm"]

[node name="Player" type="CharacterBody2D"]
y_sort_enabled = true
motion_mode = 1
script = ExtResource("1_ejvcm")
bullet_scene = ExtResource("2_vlvv2")
weapon_scene = ExtResource("7_vlvv2")
bullets = Dictionary[String, PackedScene]({
"arrow": ExtResource("2_vlvv2"),
"bomb": ExtResource("4_mak8i")
})
metadata/_custom_type_script = "uid://c3g0gk37yr2r2"

[node name="Sprite2D" type="Sprite2D" parent="."]
y_sort_enabled = true
rotation = 0.00226489
texture = ExtResource("2_c85qa")
hframes = 3
vframes = 4
frame = 7

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
rotation = 0.00733251
shape = SubResource("CircleShape2D_1s68y")

[node name="Hurtbox" type="Area2D" parent="." node_paths=PackedStringArray("health_component")]
script = ExtResource("3_vlvv2")
health_component = NodePath("../HealthComponent")
metadata/_custom_type_script = "uid://6yht3jk70p8w"

[node name="CollisionShape2D" type="CollisionShape2D" parent="Hurtbox"]
position = Vector2(0, -3)
rotation = -0.00964498
shape = SubResource("CapsuleShape2D_88c65")

[node name="Camera2D" type="Camera2D" parent="."]

[node name="FireSpawner" type="MultiplayerSpawner" parent="."]
spawn_path = NodePath(".")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_66amf")
}

[node name="Label" type="Label" parent="."]
visible = false
z_index = 1
offset_left = -173.0
offset_top = -54.0
offset_right = 175.0
offset_bottom = -26.0
text = "asdads"
label_settings = SubResource("LabelSettings_6mylm")
horizontal_alignment = 1

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeStateMachine_vbhtm")
anim_player = NodePath("../AnimationPlayer")

[node name="MultiplayerSynchronizer" type="MultiplayerSynchronizer" parent="."]
replication_config = SubResource("SceneReplicationConfig_74jyu")

[node name="InputSynchronizer" parent="." instance=ExtResource("4_d71b8")]

[node name="BulletSpawner" type="MultiplayerSpawner" parent="."]
spawn_path = NodePath(".")

[node name="healthbar" parent="." instance=ExtResource("7_d71b8")]

[node name="HealthComponent" parent="." instance=ExtResource("9_1s68y")]

[node name="RemoteHealthbar" parent="." instance=ExtResource("10_88c65")]
offset_left = -32.0
offset_top = -31.0
offset_right = 8.0
offset_bottom = 9.0

[node name="Control" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0
script = ExtResource("11_88c65")

[node name="CanvasLayer" type="CanvasLayer" parent="Control"]

[node name="CenterContainer" type="CenterContainer" parent="Control/CanvasLayer"]
anchors_preset = 11
anchor_left = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -137.0
offset_right = 15.0
grow_horizontal = 0
grow_vertical = 2
scale = Vector2(0.9066469, 1.0199817)

[node name="TextureRect" type="TextureRect" parent="Control/CanvasLayer/CenterContainer"]
custom_minimum_size = Vector2(152, 162)
layout_mode = 2
texture = ExtResource("12_6mylm")
expand_mode = 1
stretch_mode = 5

[node name="RichTextLabel" type="RichTextLabel" parent="Control/CanvasLayer/CenterContainer/TextureRect"]
layout_mode = 0
offset_left = 37.50082
offset_top = 20.412292
offset_right = 114.70839
offset_bottom = 134.13982
theme_override_colors/default_color = Color(0, 0, 0, 1)
theme_override_fonts/normal_font = ExtResource("13_74jyu")
theme_override_font_sizes/normal_font_size = 5
text = "M1 (Click izquierdo)
Flecha normal: hace daño a enemigos y puede golpear dianas

M2 (click derecho)
Flecha magica: stunea a enemigos y rompe estructuras huecas

WASD
Movimiento

R
Revivir compañero caido"
tab_size = 3
context_menu_enabled = true

[node name="Pause_menu" parent="." instance=ExtResource("13_vbhtm")]

[node name="arrow_couldown" type="Timer" parent="."]
unique_name_in_owner = true
wait_time = 0.25

[node name="bomb_arrow_couldown" type="Timer" parent="."]
unique_name_in_owner = true
wait_time = 0.5

[node name="revive_area" type="Area2D" parent="."]

[node name="CollisionShape2D" type="CollisionShape2D" parent="revive_area"]
scale = Vector2(4, 4)
shape = SubResource("CircleShape2D_vbhtm")
